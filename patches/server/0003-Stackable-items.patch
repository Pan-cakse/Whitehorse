From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: VidTu <60929459+VidTu@users.noreply.github.com>
Date: Thu, 30 Mar 2023 09:37:46 +0300
Subject: [PATCH] Stackable items


diff --git a/src/main/java/net/minecraft/world/item/ItemStack.java b/src/main/java/net/minecraft/world/item/ItemStack.java
index 45d864679816cb39420e079d37220a967e9d71d1..11acf48670f8c0ccdbd850df14a2b04be7d052e3 100644
--- a/src/main/java/net/minecraft/world/item/ItemStack.java
+++ b/src/main/java/net/minecraft/world/item/ItemStack.java
@@ -548,6 +548,12 @@ public final class ItemStack {
     }
 
     public int getMaxStackSize() {
+        // Whitehorse start - stackable items
+        if (this.tag != null && this.tag.contains("Whitehorse.MaxStackSize")) {
+            byte maxStackSize = this.tag.getByte("Whitehorse.MaxStackSize");
+            if (maxStackSize > 0 && maxStackSize <= 64) return maxStackSize;
+        }
+        // Whitehorse end
         return this.getItem().getMaxStackSize();
     }
 
diff --git a/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java b/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java
index 0e7a6a5a83b4630f53e6dba1b5b29f67d91c7240..1c43adeb635695a5d6f1454b1d3f70681e50bc10 100644
--- a/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java
+++ b/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java
@@ -170,7 +170,7 @@ public final class CraftItemStack extends ItemStack {
 
     @Override
     public int getMaxStackSize() {
-        return (this.handle == null) ? Material.AIR.getMaxStackSize() : this.handle.getItem().getMaxStackSize();
+        return (this.handle == null) ? Material.AIR.getMaxStackSize() : this.handle.getMaxStackSize(); // Whitehorse - stackable items
     }
 
     // Paper start
